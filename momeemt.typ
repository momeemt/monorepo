#set text(font: "Hiragino Kaku Gothic ProN")

= 開発したいテーマ
私は拡張性を高く持つマークアップ言語であるBrackを開発したいと考えています。
このテーマは同日に提出された上野幹太さんと共同で進めているプロジェクトで、担当箇所を明確に切り分けています。
私はプラグインの実装とプロジェクト管理を中心に、彼はパーサとLanguage Serverの実装を担当します。
お互いの書類でBrackの概要と担当箇所のやりたいことについて説明します。

== Brackの概要
#include "brack-overview.typ"

== プラグイン
Brackの格は文法ではなくプラグインにあります。
プラグインはWebAssemblyのバイナリを指しており、Brack文書をパースすることにより得られるプラグイン名とコマンド名を元に、Wasmバイナリを呼び出します。
一見シンプルな仕組みですが、執筆体験と汎用性を維持するためには考慮するべきことが多くあります。

=== メタデータ
Wasmは静的に型付けがされますが、組み込み型としては整数型のみを持ちます。
実装に用いているExtismは何らかのルールによって構造体や文字列などをメモリ上に展開しているのですが、その影響でRustなどが本来持っている型の表現力による恩恵をそのまま受けることはできません。
具体的には、Extismはプラグイン関数に対して1つの引数のみを持つことを要請するため、複数のデータをやり取りしたい場合には構造体を用いることで、可変長引数を表現したい場合には`enum`を用いることで対処するしかありません。
しかし、こうなるとバイナリから関数がどのようなデータを要求しているのかを読み出すのは非常に困難です。
そこで、Brackの実装ではあらかじめプラグインを読み出した時点で以下の情報を得るための関数を連続して呼び出します。この情報を便宜的にメタデータと呼んでいます。

- (Brackにおける) コマンド名
- (Wasmバイナリにおける) 関数名
- 引数型
- 戻り値型

メタデータを初期化時に得ることで、Wasmの

== プロジェクト管理

= 計画

= 自己アピール
